language: python

env:
    - PHASE="test"
    - PHASE="syntax"
    - PHASE="docs"

build:
    ci:
    - pip install --upgrade pip
    - pip install -e .[develop]
    - mkdir -p shippable/testresults shippable/codecoverage
    - if [ $PHASE == "test" ]; then py.test --cov=falafel --cov-report=xml --junit-xml=shippable/testresults/results.xml; fi
    - if [ $PHASE == "test" ]; then mv coverage.xml shippable/codecoverage; fi
    - if [ $PHASE == "syntax" ]; then flake8; fi
    - if [ $PHASE == "docs" ]; then sphinx-build -W -b html -qa -E docs docs/_build/html; fi
