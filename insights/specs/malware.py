import json
from insights.core.context import HostContext
from insights.core.dr import SkipComponent
from insights.specs import Specs
from insights.core.plugins import datasource
from insights.core.spec_factory import DatasourceProvider

class MalwareSpecs(Specs):
    @datasource(HostContext)
    def run_malware(broker):
        # DatasourceProvider is a generic object for adding content to the archive
        #   content = the file content to write
        #   relative_path = filepath to which to write, relative to "data" dir in the archive

        # replace with logic to populate output
        test_content = json.dumps({"test": "test"})

        return DatasourceProvider(content=test_content, relative_path="malware-results.json")
        raise SkipComponent