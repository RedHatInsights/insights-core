/*
    Rule to verify the operation of Red Hat Insights Malware Detection.
    This rule is expected to trigger matches when the Malware Detection Client is present on a system.
*/

rule TEST_RedHatInsightsMalwareDetection
{
    meta:
        author = "Red Hat Insights"
        description = "Verifies the Red Hat Insights Malware Detection client is present on the system"
        usage = "Verification"
        date_created = "11 June 2021"
        date_updated = "7 July 2021"

    strings:
        $s1 = "class MalwareDetectionClient:" fullword
        $s2 = /__version__ = "[0-9.]+"/
        $s3 = /MIN_YARA_VERSION = "[0-9.]+"/

    condition:
        $s1 and ($s2 or $s3)
}
